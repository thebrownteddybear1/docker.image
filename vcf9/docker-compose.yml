version: '3.8'

services:
  vcf-manager:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: vcf-offline-depot
    # Required for OpenConnect to create the VPN tunnel (tun0)
    privileged: true
    # Ensures the container can manage network interfaces
    cap_add:
      - NET_ADMIN
    devices:
      - "/dev/net/tun:/dev/net/tun"
    ports:
      - "22:22"   # SSH Access
      - "80:80"   # HTTP Depot
      - "443:443" # HTTPS Depot
    volumes:
      # Map a local folder to /depot so your binaries persist 
      # even if the container is deleted
      - ./depot_binaries:/depot
    restart: unless-stopped
    stdin_open: true
    tty: true

networks:
  default:
    name: vcf_network